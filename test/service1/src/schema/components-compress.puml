@startuml
remove @unlinked
package "service1" as service1 #line.dotted;text:gray {
  package "api" as service1.api #line.dotted;text:gray {
    package "http" as service1.api.http #line.dotted;text:gray {
      component mainController as mainController
    }
    package "ws" as service1.api.ws #line.dotted;text:gray {
      component eventsHandler as eventsHandler
    }
  }
  package "db" as service1.db #line.dotted;text:gray {
    package "jpa" as service1.db.jpa #line.dotted;text:gray {
      collections "<#transparent,transparent>|simpleEntityRepository|\n\
<#transparent,transparent>|userRepository|" as service1.db.jpa.components
    }
    package "mongo" as service1.db.mongo #line.dotted;text:gray {
      component documentRepository as documentRepository
    }
  }
  package "service" as service1.service #line.dotted;text:gray {
    component coreService as coreService
    package "external" as service1.service.external #line.dotted;text:gray {
      package "jms" as service1.service.external.jms #line.dotted;text:gray {
        collections "<#transparent,transparent>|jmsQueueListener|\n\
<#transparent,transparent>|jmsQueueService|" as service1.service.external.jms.components
      }
      package "rest" as service1.service.external.rest #line.dotted;text:gray {
        collections "<#transparent,transparent>|service2FeignClient|\n\
<#transparent,transparent>|service2LegacyImpl|\n\
<#transparent,transparent>|standaloneService2Api|" as service1.service.external.rest.components
      }
      package "ws" as service1.service.external.ws #line.dotted;text:gray {
        component service2StreamClientImpl as service2StreamClientImpl
      }
    }
  }
}
mainController ..> coreService
coreService ..> documentRepository
coreService ..> service1.service.external.rest.components
coreService ..> service1.db.jpa.components
service1.service.external.jms.components ..> coreService
cloud "input" as input #line.dotted;line:gray; {
  rectangle "http" as input.http {
    frame "/api/v1" as input.http..api.v1 #line.dotted;text:gray {
      collections "<#transparent,transparent>|<r>*: | |\n\
<#transparent,transparent>|<r>GET: |/load|\n\
<#transparent,transparent>|<r>POST: |/put|" as input.http..api.v1.interfaces
      input.http..api.v1.interfaces 0)....> mainController
    }
  }
  rectangle "web socket" as input.websocket {
    frame "eventsHandler" as input.websocket.eventsHandler.eventsHandler.interfaces #line.dotted;text:gray {
      interface "/events" as in.eventsHandler.in.ws..events
      in.eventsHandler.in.ws..events )....> eventsHandler
    }
  }
  queue "jms" as input.jms {
    frame "jmsQueueListener" as input.jms.jmsQueueListener.jmsQueueListener.interfaces #line.dotted;text:gray {
      collections "<#transparent,transparent>|queue1|\n\
<#transparent,transparent>|queue2|" as input.jms.jmsQueueListener.interfaces
      input.jms.jmsQueueListener.interfaces 0)....> service1.service.external.jms.components
    }
    frame "jmsQueueService" as input.jms.jmsQueueService.jmsQueueService.interfaces #line.dotted;text:gray {
      interface "default" as in.jmsQueueService.default.in
      in.jmsQueueService.default.in )....> service1.service.external.jms.components
    }
  }
}
cloud "internal" as internal #line.dotted;line:gray; {
  database "storage" as internal.storage {
    folder "jpa.model" as internal.storage.jpa.model #line.dotted;line:gray; {
      collections "<#transparent,transparent>|SimpleEntity|\n\
<#transparent,transparent>|UserEntity|" as internal.storage.jpa.model.interfaces
      internal.storage.jpa.model.interfaces .. service1.db.jpa.components
    }
    folder "mongo.model" as internal.storage.mongo.model #line.dotted;line:gray; {
      entity "DocumentEntity" as internal.mongo.classservice1.db.mongo.model.DocumentEntity..documentEntity.
      note "documentEntity" as internal.mongo.classservice1.db.mongo.model.DocumentEntity..documentEntity..table_name
      internal.mongo.classservice1.db.mongo.model.DocumentEntity..documentEntity..table_name .. internal.mongo.classservice1.db.mongo.model.DocumentEntity..documentEntity.
      internal.mongo.classservice1.db.mongo.model.DocumentEntity..documentEntity. .. documentRepository
    }
  }
}
cloud "output" as output #line.dotted;line:gray; {
  queue "jms" as output.jms {
    frame "jmsQueueService" as output.jms.jmsQueueService.jmsQueueService.interfaces #line.dotted;text:gray {
      collections "<#transparent,transparent>|jms-private-queue|\n\
<#transparent,transparent>|jmsQueue1|\n\
<#transparent,transparent>|jmsQueue2|\n\
<#transparent,transparent>|jmsQueueEvents|\n\
<#transparent,transparent>|jmsQueueEvents2|\n\
<#transparent,transparent>|jmsQueueEvents3|" as output.jms.jmsQueueService.interfaces
      service1.service.external.jms.components ....> output.jms.jmsQueueService.interfaces
    }
  }
  rectangle "http" as output.http {
    interface "GET:/standalone-service2" as out.GET.standalone.service2..id.
    service1.service.external.rest.components ....( out.GET.standalone.service2..id.
    frame "http://service2" as output.http.http...service2 #line.dotted;text:gray {
      collections "<#transparent,transparent>|<r>GET: | |\n\
<#transparent,transparent>|<r>GET: |/{id}|" as output.http.http...service2.interfaces
      service1.service.external.rest.components ....(0 output.http.http...service2.interfaces
    }
  }
  rectangle "web socket" as output.websocket {
    frame "service2StreamClientImpl" as output.websocket.service2StreamClientImpl.service2StreamClientImpl.interfaces #line.dotted;text:gray {
      collections "<#transparent,transparent>|ws://currentURI-method |ws://service3|\n\
<#transparent,transparent>|ws://currentURI-supplier | |\n\
<#transparent,transparent>|ws://defaultURI-static | |\n\
<#transparent,transparent>|ws://service-property-injected | |\n\
<#transparent,transparent>|ws://service-template | |\n\
<#transparent,transparent>|ws://service-template/{id}/ | |\n\
<#transparent,transparent>|ws://service2 | |\n\
<#transparent,transparent>|ws://service2-value-inject | |" as output.websocket.service2StreamClientImpl.interfaces
      service2StreamClientImpl ....(0 output.websocket.service2StreamClientImpl.interfaces
    }
  }
}
@enduml
